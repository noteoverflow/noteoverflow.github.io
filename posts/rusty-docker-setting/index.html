<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="index, follow" name=robots><link href=https://noteoverflow.github.io/rss.xml rel=alternate title=RSS type=application/rss+xml><title>noteoverflow | Rusty docker setting</title><link as=style href=https://noteoverflow.github.io/css/style.css rel=preload><link crossorigin href=https://noteoverflow.github.io/css/reset-min.css rel=stylesheet><link crossorigin href=https://noteoverflow.github.io/css/suCSS-min.css rel=stylesheet><link href=https://noteoverflow.github.io/css/style.css rel=stylesheet><link href=https://noteoverflow.github.io/css/custom.css rel=stylesheet><link href=https://noteoverflow.github.io/img/favicon.ico rel=icon><body><nav id=nav-bar><a href=/posts> [post] </a><a href=/pinned> [pin] </a><a href=/tags> [tag] </a><a href=/> [self] </a>   <div aria-label="Toggle theme" class=theme-toggle data-icon-base=https://noteoverflow.github.io/icons.svg data-icon-dark=#darkMode data-icon-light=#lightMode data-sound-src=https://noteoverflow.github.io/click.ogg id=theme-toggle role=button tabindex=0><svg class=icon><use id=theme-icon></use></svg></div></nav><main><article class=post><header class=post-header><time datetime=2024-10-26>Published on: <span class=accent-data>2024-10-26</span> </time><div class=post-tags><a class=tag href=/tags/programming>#programming </a><a class=tag href=/tags/rust>#rust </a></div><h1>Rusty docker setting</h1></header><div class=post-content><p>Recently I'm learning debugging and profiling tools of <em>Rust</em> on <em>Linux</em>. I utilize docker to build a debian container and install various kinds of tools(e.g., LLDB, perf). However, to use LLDB in docker container, there're some notices which one may need to care.<h2 id=lldb-python3-lib-path-problem>LLDB python3 lib path problem</h2><p>I install LLDB ion the official Rust image via:<pre class=language-sh data-lang=sh style=color:#ccc9c2;background-color:#212733><code class=language-sh data-lang=sh><span style=color:#ffd580>apt-get</span><span> install lldb python3-lldb
</span></code></pre><p>But when I typed <code>rust-lldb</code>, I encountered the following error messages:<pre style=color:#ccc9c2;background-color:#212733><code><span>ModuleNotFoundError: No module named ‘lldb.embedded_interpreter’ · Issue #55575 · llvm/llvm-project;
</span></code></pre><p>After quite some googling, I found this script useful:<pre class=language-sh data-lang=sh style=color:#ccc9c2;background-color:#212733><code class=language-sh data-lang=sh><span style=color:#ffd580>ln</span><span style=color:#fc6> -s</span><span> /usr/lib/llvm-14/lib/python3.11/dist-packages/lldb/</span><span style=color:#f29e74>*</span><span> /usr/lib/python3/dist-packages/lldb/
</span></code></pre><p>Still, the version of python may vary on different lldb versions. Replace the actual version number if necessary.<h2 id=container-addtional-options>Container addtional options</h2><p>When I thought "I have fixed the python3 problem and here we go!", another problem arises. I just cannot use LLDB commands!<p>It turns out that I have to include some addtional options to enable debugging:<pre class=language-sh data-lang=sh style=color:#ccc9c2;background-color:#212733><code class=language-sh data-lang=sh><span style=color:#ffd580>docker</span><span> run</span><span style=color:#fc6> -dit --cap-add</span><span style=color:#f29e74>=</span><span>SYS_PTRACE</span><span style=color:#fc6> --security-opt</span><span> seccomp=unconfined rust
</span></code></pre><p>Now LLDB is ready for debugging rust programs!</div></article></main><footer><br><div id=footer-container><i><a href=/internal/test>Q.E.D.</a></i></div><br></footer><script defer src=https://noteoverflow.github.io/js/script.js></script><div class=comments></div>
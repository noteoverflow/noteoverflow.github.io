<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="index, follow" name=robots><link href=https://noteoverflow.github.io/rss.xml rel=alternate title=RSS type=application/rss+xml><title>noteoverflow | Golang does have sum types, however...</title><link as=style href=https://noteoverflow.github.io/css/style.css rel=preload><link crossorigin href=https://noteoverflow.github.io/css/reset-min.css rel=stylesheet><link crossorigin href=https://noteoverflow.github.io/css/suCSS-min.css rel=stylesheet><link href=https://noteoverflow.github.io/css/style.css rel=stylesheet><link href=https://noteoverflow.github.io/css/custom.css rel=stylesheet><link href=https://noteoverflow.github.io/img/favicon.ico rel=icon><body><nav id=nav-bar><a href=/> [post] </a><a href=/pinned> [pinned] </a><a href=/tags> [tag] </a><a href=/about> [about] </a> Â  <div aria-label="Toggle theme" class=theme-toggle data-icon-base=https://noteoverflow.github.io/icons.svg data-icon-dark=#darkMode data-icon-light=#lightMode data-sound-src=https://noteoverflow.github.io/click.ogg id=theme-toggle role=button tabindex=0><svg class=icon><use id=theme-icon></use></svg></div></nav><main><article class=post><header class=post-header><time datetime=2024-08-11>Published on: <span class=accent-data>2024-08-11</span> </time><h1>Golang does have sum types, however...</h1></header><div class=post-content><blockquote><p>Golang has no sum type!</blockquote><p>People like to say that golang lacks <em>sum types</em>. For example, in Rust we can write a simple <code>Result</code> type:<pre class=language-rust data-lang=rust style=color:#c0c5ce;background-color:#2b303b><code class=language-rust data-lang=rust><span style=color:#b48ead>enum </span><span>Result&lt;T, E> {
</span><span>    Ok(T),
</span><span>    Err(E),
</span><span>}
</span></code></pre><p>Here <code>Result</code> is a sum type which can only be one variant(<code>Ok</code> or <code>Err</code>) but not both. Sum types are really useful to constraint values. In category theory, sum type is dual to product type, which is a universal type. If product types can be written as <code>a * b</code>, then sum types can be written as <code>a + b</code>.<p>Golang lacks direct support on sum types, but we can still simulate it:<pre class=language-go data-lang=go style=color:#c0c5ce;background-color:#2b303b><code class=language-go data-lang=go><span style=color:#b48ead>type </span><span>result[</span><span style=color:#bf616a>T</span><span>, </span><span style=color:#bf616a>E any</span><span>] </span><span style=color:#b48ead>interface </span><span>{
</span><span>    </span><span style=color:#8fa1b3>isResult</span><span>()
</span><span>}
</span><span>
</span><span style=color:#b48ead>type </span><span>Result[</span><span style=color:#bf616a>T</span><span>, </span><span style=color:#bf616a>E any</span><span>] </span><span style=color:#b48ead>struct </span><span>{
</span><span>    </span><span style=color:#bf616a>inner </span><span style=color:#b48ead>result</span><span>[</span><span style=color:#bf616a>T</span><span>, </span><span style=color:#bf616a>E</span><span>]
</span><span>}
</span><span>
</span><span>
</span><span style=color:#b48ead>type </span><span>Ok[</span><span style=color:#bf616a>T</span><span>, </span><span style=color:#bf616a>E any</span><span>] </span><span style=color:#b48ead>struct </span><span>{
</span><span>    </span><span style=color:#bf616a>value </span><span style=color:#b48ead>T
</span><span>}
</span><span style=color:#b48ead>type </span><span>Err[</span><span style=color:#bf616a>T</span><span>, </span><span style=color:#bf616a>E any</span><span>] </span><span style=color:#b48ead>struct </span><span>{
</span><span>    </span><span style=color:#bf616a>err </span><span style=color:#b48ead>E
</span><span>}
</span><span>
</span><span style=color:#b48ead>func </span><span>(</span><span style=color:#bf616a>Ok</span><span>[</span><span style=color:#bf616a>T</span><span>, </span><span style=color:#bf616a>E</span><span>]) </span><span style=color:#8fa1b3>isResult</span><span>() {}
</span><span style=color:#b48ead>func </span><span>(</span><span style=color:#bf616a>Err</span><span>[</span><span style=color:#bf616a>T</span><span>, </span><span style=color:#bf616a>E</span><span>]) </span><span style=color:#8fa1b3>isResult</span><span>() {}
</span><span>
</span><span style=color:#b48ead>func </span><span>(</span><span style=color:#bf616a>res </span><span style=color:#b48ead>Result</span><span>[</span><span style=color:#bf616a>T</span><span>, </span><span style=color:#bf616a>E</span><span>]) </span><span style=color:#8fa1b3>Switch</span><span>() </span><span style=color:#b48ead>result</span><span>[</span><span style=color:#bf616a>T</span><span>, </span><span style=color:#bf616a>E</span><span>] {
</span><span>    </span><span style=color:#b48ead>return </span><span style=color:#bf616a>res</span><span>.</span><span style=color:#bf616a>inner
</span><span>}
</span></code></pre><p>To match variants:<pre class=language-go data-lang=go style=color:#c0c5ce;background-color:#2b303b><code class=language-go data-lang=go><span style=color:#b48ead>func </span><span style=color:#bf616a>matching</span><span>[</span><span style=color:#bf616a>T</span><span>, </span><span style=color:#bf616a>E any</span><span>](</span><span style=color:#bf616a>res Result</span><span>[</span><span style=color:#bf616a>T</span><span>, </span><span style=color:#bf616a>E</span><span>]) {
</span><span>    </span><span style=color:#b48ead>switch </span><span style=color:#bf616a>r </span><span>:= </span><span style=color:#bf616a>res</span><span>.</span><span style=color:#bf616a>Switch</span><span>().(</span><span style=color:#b48ead>type</span><span>) {
</span><span>    </span><span style=color:#b48ead>case </span><span style=color:#bf616a>Ok</span><span>[</span><span style=color:#bf616a>T</span><span>, </span><span style=color:#bf616a>E</span><span>]:
</span><span>        </span><span style=color:#bf616a>_ </span><span>= </span><span style=color:#bf616a>r</span><span>.</span><span style=color:#bf616a>value
</span><span>    </span><span style=color:#b48ead>case </span><span style=color:#bf616a>Err</span><span>[</span><span style=color:#bf616a>T</span><span>, </span><span style=color:#bf616a>E</span><span>]:
</span><span>    </span><span style=color:#b48ead>default</span><span>:
</span><span>    }
</span><span>}
</span></code></pre><p>However, since golang doest not have generic methods, its function is still limited(golang team is far too conservative)...<p>Although we can simulate <code>Result</code> sum type in Golang, we are still forced to use (T, error) and write <code>if err != nil</code> lol. What a great language!</div><div class=post-tags><a class=tag href=/tags/programming>#programming </a><a class=tag href=/tags/golang>#golang </a></div></article></main><footer><hr><div id=footer-container><i><a href=/test>Q.E.D.</a></i></div><br></footer><script defer src=https://noteoverflow.github.io/js/script.js></script>